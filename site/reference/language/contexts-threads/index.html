<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Contexts and Threads - HarmonyDocs</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../../css/theme.css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Contexts and Threads";
    var mkdocs_page_input_path = "reference/language/contexts-threads.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> HarmonyDocs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../..">Overview</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Getting Started</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../guides/introduction/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../guides/installation/">Installation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../guides/running-harmony/">Running a program</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Reference</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="#">Language</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../value-types/">Values</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../statements/">Statements</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../machine-instructions/">Machine Instructions</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Contexts and Threads</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#details">Details</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../harmony-vm/">The Harmony VM</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Library</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../library/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../library/alloc/">alloc</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../library/bag/">bag</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../library/hoare/">hoare</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../library/list/">list</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../library/set/">set</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../library/synch/">synch</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../textbook/">Textbook</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../changelog/">Changelog</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">HarmonyDocs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Language &raquo;</li>
        
      
        
          <li>Reference &raquo;</li>
        
      
    
    <li>Contexts and Threads</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="contexts-and-threads">Contexts and Threads</h1>
<p>A context captures the state of a thread. Each time the thread executes an instruction, it goes from one context to another. All instructions update the program counter (<code>Jump</code> instructions are not allowed to jump to their own locations), and so no instruction leaves the context the same. There may be multiple threads with the same state at the same time. A context consists of the following:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td>the name of the main method that the thread is executing</td>
</tr>
<tr>
<td><code>argument</code></td>
<td>the argument given to the main method</td>
</tr>
<tr>
<td><code>program counter</code></td>
<td>an integer value pointing into the code</td>
</tr>
<tr>
<td><code>frame pointer</code></td>
<td>an integer value pointing into the stack</td>
</tr>
<tr>
<td><code>atomic</code></td>
<td>if non-zero, the thread is in atomic mode</td>
</tr>
<tr>
<td><code>readonly</code></td>
<td>if non-zero, the thread is in read-only mode</td>
</tr>
<tr>
<td><code>stack</code></td>
<td>a list of Harmony values</td>
</tr>
<tr>
<td><code>method variables</code></td>
<td>a dictionary mapping atoms (names of method variables) to values</td>
</tr>
<tr>
<td><code>thread-local variables</code></td>
<td>a dictionary mapping atoms (names of thread-local variables) to values</td>
</tr>
<tr>
<td><code>stopped</code></td>
<td>a boolean indicating if the context is stopped</td>
</tr>
<tr>
<td><code>failure</code></td>
<td>if not None, string that describes how the thread failed</td>
</tr>
</tbody>
</table>
<p><br /></p>
<h3 id="details">Details</h3>
<ul>
<li>
<p>The frame pointer points to the current <em>stack frame</em>, which consists of the caller's frame pointer and variables, the argument to the method, an "invocation type atom" (<code>normal</code>, <code>interrupt</code>, or <code>thread</code>), and the return address (in case of <code>normal</code>).</p>
</li>
<li>
<p>A thread terminates when it reaches the <code>Return</code> instruction of the top-level method (when the stack frame is of type <code>thread</code>) or when it hits an exception. Exceptions include divide by zero, reading a non-existent key in a dictionary, accessing a non-existent variable, as well as when an assertion fails;</p>
</li>
<li>
<p>The execution of a thread in <em>atomic mode</em> does not get interleaved with that of other threads.</p>
</li>
<li>
<p>The execution of a thread in <em>read-only mode</em> is not allowed to update shared variables of spawn threads.</p>
</li>
</ul>
<p>The register of a thread always contains a dictionary, mapping atoms to arbitrary values. The atoms correspond to the variable names in a Harmony program.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../harmony-vm/" class="btn btn-neutral float-right" title="The Harmony VM">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../machine-instructions/" class="btn btn-neutral" title="Machine Instructions"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../machine-instructions/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../harmony-vm/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
